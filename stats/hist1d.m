%-------------------%% hist1d.m%% [hh,bh,gh]=hist1d(signal,nbbins);% plot(bh,hh); hold; plot(bh,gh,'--')%% P.A.%-------------------------function [hh,bh,gh]=hist1d(signal,nbbins);mi=min(signal);ma=max(signal);pas=(ma-mi)/(nbbins-1);nn=length(signal);bh=mi:pas:ma;hh=zeros(1,nbbins);for k=1:1:nn p=fix((signal(k)-mi)/pas) +1; hh(p) = hh(p) +1;endbh=bh+pas/2;hh=hh/nn/pas;moy=sum(bh.*hh)*pas;var=sum(bh.*bh.*hh)*pas;var=var-moy*moy;gh=exp(-( (bh-moy).^2 )/2/var )/(sqrt(2*pi*var));